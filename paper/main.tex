\documentclass[10pt,conference]{IEEEtran}

% --------------------------------------------------------
% PACKAGES
% --------------------------------------------------------
\usepackage{amsmath, amssymb, amsfonts}
\usepackage{graphicx}
\usepackage{booktabs}
\usepackage{cite}
\usepackage{url}
\usepackage{mathtools}
\usepackage{multirow}
\usepackage{tikz}
\usepackage{xcolor}
\usepackage{pgfplots}
\usepackage{siunitx}
\pgfplotsset{compat=newest}

\graphicspath{{./figures/}}

% --------------------------------------------------------
% TITLE & AUTHOR
% --------------------------------------------------------
\title{
Distributed Predictive-Consensus Replicator Dynamics (DPCRD)\\
for Adaptive Multi-Intersection Traffic Signal Control:\\
A Hybrid Python--SUMO Evaluation
}

\author{
\IEEEauthorblockN{Jorge Luis Mayorga}
\IEEEauthorblockA{
Email: jorge.mayorga@example.com \\ 
Distributed Control, Robotics \& Intelligent Transport Systems Researcher}
}

% --------------------------------------------------------
\begin{document}
\maketitle

% --------------------------------------------------------
\begin{abstract}
This paper proposes a novel distributed traffic signal control framework based 
on Predictive-Consensus Replicator Dynamics (DPCRD). Each intersection acts 
as an autonomous evolutionary agent whose signal phases correspond to strategies 
within a simplex. Phase proportions adapt through a replicator update integrating 
(1) local queue and delay observations, (2) demand prediction, (3) consensus 
coupling with neighboring intersections via the graph Laplacian, and (4) a 
homeostatic learning-rate modulation based on congestion stress. The resulting 
controller is completely decentralized, scalable, and robust to stochastic demand 
fluctuations and sensor failures. Theoretical properties including simplex 
invariance, boundedness, and consensus stability are derived. Extensive 
evaluations are performed in both a custom Python simulator (1, 2, and 
4-intersection networks) and a SUMO traffic simulation (3x3 grid). Comparisons 
with fixed-time, semi-actuated, consensus-only, and max-pressure control 
demonstrate significant improvements in delay, queue reduction, adaptability, 
and emergent green-wave formation. 
\end{abstract}

\begin{IEEEkeywords}
Traffic Signal Control, Distributed Control, Replicator Dynamics, Evolutionary Games, 
Consensus, SUMO, Multi-Agent Systems, Intelligent Transportation.
\end{IEEEkeywords}

% --------------------------------------------------------
\section{Introduction}
Urban congestion continues to grow worldwide, creating challenges for classical 
traffic signal controllers such as fixed-time plans and centralized adaptive 
schemes. These approaches suffer from poor adaptability, vulnerability to failures, 
and limited scalability. The increasing complexity of road networks motivates the 
development of distributed, bio-inspired, and self-organizing control methods.

This work introduces a distributed traffic controller based on \textit{Predictive-
Consensus Replicator Dynamics} (DPCRD), where each intersection independently 
adjusts the proportion of green time allocated to its phases using replicator 
evolution guided by local and predicted traffic conditions.

\subsection{Problem Statement}
We consider urban networks where each intersection must:
(i) adapt to stochastic traffic demand,
(ii) operate without centralized supervision,
(iii) coordinate with neighbors only minimally,
(iv) remain robust under sensor failures and dynamic disturbances.

\subsection{Contributions}
This paper makes the following contributions:
\begin{itemize}
    \item \textbf{C1.} A novel distributed controller based on evolutionary 
    replicator dynamics integrated with prediction, consensus, and homeostasis.
    \item \textbf{C2.} A \textit{predictive payoff} structure using anticipated 
    demand, improving responsiveness.
    \item \textbf{C3.} A \textit{Laplacian-consensus} coupling enabling propagation 
    of beneficial strategies across intersections.
    \item \textbf{C4.} A \textit{homeostatic learning-rate adaptation} based on 
    congestion stress.
    \item \textbf{C5.} Theoretical properties including simplex invariance and 
    consensus stability bounds.
    \item \textbf{C6.} Hybrid Python--SUMO experiments across 1-, 2-, 4-, and 9-
    intersection networks.
    \item \textbf{C7.} Comparisons with fixed-time, semi-actuated, consensus-only, 
    and max-pressure controllers.
    \item \textbf{C8.} Robustness evaluation under stochastic arrivals and sensor 
    failures.
\end{itemize}

% --------------------------------------------------------
\section{Related Work}
\subsection{Classical Traffic Control}
Fixed-time control remains widely deployed, offering simplicity but limited 
adaptability. Semi-actuated control adjusts green extensions based on detectors 
but lacks multi-intersection coordination.

\subsection{Distributed and Multi-Agent Control}
Multi-agent coordination, decentralized negotiation, and consensus-based methods 
have gained traction for scalable traffic control. However, few offer strong 
adaptability without requiring explicit communication of cycle times.

\subsection{Max-Pressure Control}
Max-pressure controllers optimize flows using queue differentials and enjoy 
proven stability, but require real-time queue estimation and may produce abrupt 
phase switching.

\subsection{Evolutionary and Game-Theoretic Control}
Evolutionary dynamics have been applied to distributed control in other domains, 
but applications to traffic lights remain limited and lack consensus integration, 
predictive structure, and homeostatic adaptation.

% --------------------------------------------------------
\section{Preliminaries}
\subsection{Graph and Intersection Model}
The road network is modeled as a graph $G=(V,E)$, where nodes are intersections 
and edges are roads. Each intersection $i$ contains $K_i$ phases interpreted as 
strategies.

\subsection{Replicator Dynamics}
Let $x_{i,k}$ denote the proportion of green time for phase $k$ at intersection 
$i$, such that:
\begin{equation}
x_{i,k} \ge 0,\quad \sum_{k=1}^{K_i} x_{i,k} = 1.
\end{equation}
Given payoffs $f_{i,k}$, the discrete replicator update is:
\begin{equation}
x_{i,k}^{+} = x_{i,k} + \eta\, x_{i,k} (f_{i,k} - \bar{f}_i),
\end{equation}
with $\bar{f}_i = \sum_k x_{i,k} f_{i,k}$.

\subsection{Consensus Coupling}
Neighboring intersections exchange strategy proportions. The consensus term is:
\begin{equation}
C_{i,k} = \sum_{j \in \mathcal{N}(i)} (x_{j,k} - x_{i,k}).
\end{equation}

% --------------------------------------------------------
\section{Proposed Method: DPCRD}
\subsection{Strategy Definition}
Each phase is treated as a strategy. The controller operates in the simplex.

\subsection{Predictive Payoff}
\begin{equation}
f_{i,k}(t) = -(\alpha Q_{i,k}(t) + \beta D_{i,k}(t) 
+ \delta \hat{Q}_{i,k}(t+1)).
\end{equation}
Demand prediction uses a moving-average or autoregressive estimator.

\subsection{Homeostatic Learning Rate}
\begin{equation}
\eta_i(t) = \eta_0 \left(1 + \lambda \cdot \text{Stress}_i(t)\right),
\end{equation}
where stress is a normalized measure of congestion.

\subsection{Consensus-Enhanced Replicator Update}
\begin{equation}
x_{i,k}^{+}=x_{i,k}+\eta_i x_{i,k}(f_{i,k}-\bar{f}_i)
+ \gamma C_{i,k}.
\end{equation}

\subsection{Time Conversion}
The actual green time is:
\begin{equation}
T_{i,k} = x_{i,k}\, T_{\text{cycle}}.
\end{equation}

\subsection{Algorithm Summary}
% (Here insert pseudocode if desired)

% --------------------------------------------------------
\section{Theoretical Analysis}
\subsection{Simplex Invariance}
We show that the update preserves $x_{i,k}\ge0$ and sums to one under mild 
conditions on $\eta_i$ and $\gamma$.

\subsection{Boundedness and Monotonicity}
Local stability is analyzed by linearization around equilibrium strategy 
distributions.

\subsection{Consensus Stability Condition}
A sufficient condition for stability of consensus coupling is:
\begin{equation}
\gamma < \frac{1}{\lambda_{\max}(L)},
\end{equation}
where $L$ is the graph Laplacian.

\subsection{Robustness}
We analyze perturbations in payoff estimates and sensor noise.

% --------------------------------------------------------
\section{Experimental Setup}
\subsection{Python Simulator}
We evaluate:
\begin{itemize}
    \item 1 intersection
    \item 2 intersections in line
    \item 4-node grid
\end{itemize}
Arrivals follow Poisson processes with varying intensity.

\subsection{SUMO Experiments}
We build a 3x3 urban grid with realistic vehicle dynamics and pedestrian flows. 
Perturbations include blocked lanes, arrival surges, and sensor dropout.

\subsection{Baselines}
We compare DPCRD with:
\begin{itemize}
    \item Fixed-time
    \item Semi-actuated
    \item Consensus-only replicator
    \item Max-pressure control
\end{itemize}

\subsection{Performance Metrics}
\begin{itemize}
    \item Average delay
    \item Queue length
    \item Throughput
    \item Number of stops
    \item Standard deviation (robustness)
\end{itemize}

% --------------------------------------------------------
\section{Results and Discussion}
\subsection{Single Intersection}
DPCRD adapts faster than actuated control, reducing delay under spikes.

\subsection{Two Intersections}
Consensus coupling propagates beneficial strategies and stabilizes oscillations.

\subsection{Four-Node Grid}
DPCRD forms emergent green waves without explicit coordination.

\subsection{SUMO Grid}
DPCRD outperforms max-pressure in delay reduction under stochastic demand and 
sensor failure scenarios.

% --------------------------------------------------------
\section{Limitations}
\begin{itemize}
    \item Prediction uses simple models; deep forecasting is future work.
    \item Parameter tuning requires calibration.
    \item Real-time hardware tests not included.
\end{itemize}

% --------------------------------------------------------
\section{Conclusion}
We introduced DPCRD, a fully distributed, predictive, consensus-enhanced 
replicator controller for adaptive traffic signal control. The method is simple, 
robust, scalable, and effective in both Python and SUMO simulations. Future work 
includes real-world deployment and advanced forecasting.

% --------------------------------------------------------
\bibliographystyle{IEEEtran}
\bibliography{references}

\end{document}
