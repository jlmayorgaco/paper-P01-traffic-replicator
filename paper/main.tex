\documentclass[10pt,conference]{IEEEtran}

% --------------------------------------------------------
% PACKAGES
% --------------------------------------------------------
\usepackage{amsmath, amssymb, amsfonts}
\usepackage{graphicx}
\usepackage{booktabs}
\usepackage{cite}
\usepackage{url}
\usepackage{mathtools}
\usepackage{multirow}
\usepackage{tikz}
\usepackage{xcolor}
\usepackage{pgfplots}
\usepackage{siunitx}
\pgfplotsset{compat=newest}

\graphicspath{{./figures/}}

% --------------------------------------------------------
% TITLE & AUTHOR
% --------------------------------------------------------
\title{
Distributed Evolutionary Control of Traffic Lights Using Predictive Replicator Dynamics with Homeostatic Learning
}

\author{
\IEEEauthorblockN{Jorge Luis Mayorga}
\IEEEauthorblockA{
Email: jl.mayorga236@uniandes.edu.co \\ 
Distributed Control, Robotics \& Intelligent Transport Systems Researcher}
}

% --------------------------------------------------------
\begin{document}
\maketitle

% --------------------------------------------------------
\begin{abstract}
This paper introduces a novel fully-distributed traffic signal control framework based on \emph{Predictive-Consensus Replicator Dynamics} (DPCRD). In the proposed architecture, each intersection operates as an autonomous evolutionary agent whose signal-phase plans constitute strategies within a probability simplex. Phase proportions evolve through a replicator update that integrates: (1) real-time local observations of queue lengths and delay, (2) short-term demand prediction, (3) consensus coupling with neighboring intersections over the network graph Laplacian, and (4) a homeostatic modulation mechanism that adjusts the learning rate according to a congestion-induced stress signal. The resulting controller is decentralized, communication-efficient, and inherently robust to stochastic demand fluctuations, topology changes, and sensor degradation.

Theoretical properties including simplex invariance, boundedness, and consensus-driven stability are established. The DPCRD framework is evaluated extensively in both a custom Python simulator (1-, 2-, and 4-intersection networks) and in SUMO on a 3Ã—3 urban grid. Benchmark comparisons with fixed-time, semi-actuated, consensus-only, and max-pressure controllers demonstrate significant improvements in average delay, queue reduction, responsiveness to perturbations, and the emergence of coherent green-wave patterns without centralized coordination. These results highlight DPCRD as a biologically-inspired, scalable alternative for next-generation adaptive traffic control systems.
\end{abstract}

\begin{IEEEkeywords}
Distributed traffic signal control, replicator dynamics, evolutionary game theory, homeostatic learning, consensus control, graph-based coordination, demand prediction, green-wave formation, SUMO simulation, multi-agent systems.
\end{IEEEkeywords}

% --------------------------------------------------------
\section{Introduction}

\subsection{Problem Statement}


% --------------------------------------------------------
\section{Related Work}
\subsection{Classical Traffic Control}
Fixed-time control remains widely deployed, offering simplicity but limited 
adaptability. Semi-actuated control adjusts green extensions based on detectors 
but lacks multi-intersection coordination.

\subsection{Distributed and Multi-Agent Control}
Multi-agent coordination, decentralized negotiation, and consensus-based methods 
have gained traction for scalable traffic control. However, few offer strong 
adaptability without requiring explicit communication of cycle times.

\subsection{Max-Pressure Control}
Max-pressure controllers optimize flows using queue differentials and enjoy 
proven stability, but require real-time queue estimation and may produce abrupt 
phase switching.

\subsection{Evolutionary and Game-Theoretic Control}
Evolutionary dynamics have been applied to distributed control in other domains, 
but applications to traffic lights remain limited and lack consensus integration, 
predictive structure, and homeostatic adaptation.

% --------------------------------------------------------
\section{Preliminaries}
\subsection{Graph and Intersection Model}
The road network is modeled as a graph $G=(V,E)$, where nodes are intersections 
and edges are roads. Each intersection $i$ contains $K_i$ phases interpreted as 
strategies.

\subsection{Replicator Dynamics}
Let $x_{i,k}$ denote the proportion of green time for phase $k$ at intersection 
$i$, such that:
\begin{equation}
x_{i,k} \ge 0,\quad \sum_{k=1}^{K_i} x_{i,k} = 1.
\end{equation}
Given payoffs $f_{i,k}$, the discrete replicator update is:
\begin{equation}
x_{i,k}^{+} = x_{i,k} + \eta\, x_{i,k} (f_{i,k} - \bar{f}_i),
\end{equation}
with $\bar{f}_i = \sum_k x_{i,k} f_{i,k}$.

\subsection{Consensus Coupling}
Neighboring intersections exchange strategy proportions. The consensus term is:
\begin{equation}
C_{i,k} = \sum_{j \in \mathcal{N}(i)} (x_{j,k} - x_{i,k}).
\end{equation}

% --------------------------------------------------------
\section{Proposed Method: DPCRD}
\subsection{Strategy Definition}
Each phase is treated as a strategy. The controller operates in the simplex.

\subsection{Predictive Payoff}
\begin{equation}
f_{i,k}(t) = -(\alpha Q_{i,k}(t) + \beta D_{i,k}(t) 
+ \delta \hat{Q}_{i,k}(t+1)).
\end{equation}
Demand prediction uses a moving-average or autoregressive estimator.

\subsection{Homeostatic Learning Rate}
\begin{equation}
\eta_i(t) = \eta_0 \left(1 + \lambda \cdot \text{Stress}_i(t)\right),
\end{equation}
where stress is a normalized measure of congestion.

\subsection{Consensus-Enhanced Replicator Update}
\begin{equation}
x_{i,k}^{+}=x_{i,k}+\eta_i x_{i,k}(f_{i,k}-\bar{f}_i)
+ \gamma C_{i,k}.
\end{equation}

\subsection{Time Conversion}
The actual green time is:
\begin{equation}
T_{i,k} = x_{i,k}\, T_{\text{cycle}}.
\end{equation}

\subsection{Algorithm Summary}
% (Here insert pseudocode if desired)

% --------------------------------------------------------
\section{Theoretical Analysis}
\subsection{Simplex Invariance}
We show that the update preserves $x_{i,k}\ge0$ and sums to one under mild 
conditions on $\eta_i$ and $\gamma$.

\subsection{Boundedness and Monotonicity}
Local stability is analyzed by linearization around equilibrium strategy 
distributions.

\subsection{Consensus Stability Condition}
A sufficient condition for stability of consensus coupling is:
\begin{equation}
\gamma < \frac{1}{\lambda_{\max}(L)},
\end{equation}
where $L$ is the graph Laplacian.

\subsection{Robustness}
We analyze perturbations in payoff estimates and sensor noise.

% --------------------------------------------------------
\section{Experimental Setup}
\subsection{Python Simulator}
We evaluate:
\begin{itemize}
    \item 1 intersection
    \item 2 intersections in line
    \item 4-node grid
\end{itemize}
Arrivals follow Poisson processes with varying intensity.

\subsection{SUMO Experiments}
We build a 3x3 urban grid with realistic vehicle dynamics and pedestrian flows. 
Perturbations include blocked lanes, arrival surges, and sensor dropout.

\subsection{Baselines}
We compare DPCRD with:
\begin{itemize}
    \item Fixed-time
    \item Semi-actuated
    \item Consensus-only replicator
    \item Max-pressure control
    \item MARL
    \item PPO multiagente
    \item A2C coordinado
    \item GAT-DQN
\end{itemize}

\subsection{Performance Metrics}
\begin{itemize}
    \item Average delay
    \item Queue length
    \item Throughput
    \item Number of stops
    \item Standard deviation (robustness)
\end{itemize}

% --------------------------------------------------------
\section{Results and Discussion}
\subsection{Single Intersection}
DPCRD adapts faster than actuated control, reducing delay under spikes.

\subsection{Two Intersections}
Consensus coupling propagates beneficial strategies and stabilizes oscillations.

\subsection{Four-Node Grid}
DPCRD forms emergent green waves without explicit coordination.

\subsection{SUMO Grid}
DPCRD outperforms max-pressure in delay reduction under stochastic demand and 
sensor failure scenarios.

% --------------------------------------------------------
\section{Limitations}
\begin{itemize}
    \item Prediction uses simple models; deep forecasting is future work.
    \item Parameter tuning requires calibration.
    \item Real-time hardware tests not included.
\end{itemize}

% --------------------------------------------------------
\section{Conclusion}
We introduced DPCRD, a fully distributed, predictive, consensus-enhanced 
replicator controller for adaptive traffic signal control. The method is simple, 
robust, scalable, and effective in both Python and SUMO simulations. Future work 
includes real-world deployment and advanced forecasting.

% --------------------------------------------------------
\bibliographystyle{IEEEtran}
\bibliography{references}

\end{document}
